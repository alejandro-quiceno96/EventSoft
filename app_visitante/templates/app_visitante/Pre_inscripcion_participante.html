{% load static %}
<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Preinscripci√≥n Participante</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'app_visitante/css/styles_parti.css' %}">
  <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
  
</head>

<body>
  <header class="header">
    <h1 class="brand">Registro Participante</h1>
  </header>

<main class="form-container">
  <a href="{% url 'app_visitante:detalle_evento' evento.id %}" class="btn-volver">
    <i class="fa-solid fa-arrow-left"></i> Volver
  </a>

  <h2>Formulario de Preinscripci√≥n</h2>
  <h3 class="nombre-evento">Evento: {{ evento.eve_nombre }}</h3>

  <p class="text-info">Seleccione una opci√≥n para continuar.</p>

  <div class="radio-options">
  <label>
    <input type="radio" name="opcion" value="asociar" required onchange="mostrarFormulario(this.value)">
    <span>Asociar a un Proyecto Existente</span>
  </label>
  <label>
    <input type="radio" name="opcion" value="inscribir" onchange="mostrarFormulario(this.value)">
    <span>Inscribir un Nuevo Proyecto</span>
  </label>
</div>

  <!-- üîπ Formulario: Asociar Proyecto -->
  <form id="form-asociar" class="hidden" action="{% url 'app_visitante:submit_preinscripcion_participante' %}" method="post">
    {% csrf_token %}
    <input type="hidden" name="evento_id" value="{{ evento_id|default:evento.id }}">
    <input type="hidden" name="proyecto_id" id="proyecto_id">
    <input type="hidden" name="opcion" value="asociar">

    <h3>Asociar a un Proyecto Existente</h3>

    <label for="codigo_proyecto">C√≥digo del Proyecto</label>
    <div class="codigo-proyecto-group">
      <input type="text" id="codigo_proyectos" name="codigo_proyecto" maxlength="50" placeholder="Ej. PROY-12345" required>
      <button type="button" id="btn-buscar-proyecto" class="btn-buscar">Buscar</button>
    </div>

    <button id="btnAsociar" type="submit" class="btn-submit" disabled style="opacity: 0.5; cursor: not-allowed;">Asociar Proyecto</button>
  </form>

  <!-- üîπ Formulario: Inscribir Proyecto -->
  <form id="form-inscribir" class="hidden" action="{% url 'app_visitante:submit_preinscripcion_participante' %}" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <input type="hidden" name="evento_id" value="{{ evento_id|default:evento.id }}">
    <input type="hidden" name="opcion" value="inscribir">

    <h3>Inscribir un Nuevo Proyecto</h3>

    <label for="pro_nombre_nuevo">Nombre del Proyecto</label>
    <input type="text" id="pro_nombre_nuevo" name="pro_nombre" maxlength="100" placeholder="Ej. Innovaci√≥n Verde" required>

    <label for="pro_descripcion_nuevo">Descripci√≥n</label>
    <textarea id="pro_descripcion_nuevo" name="pro_descripcion" maxlength="400" rows="4" placeholder="Describe brevemente tu proyecto..." required></textarea>

    <label for="pro_documentos" class="file-label">
      <i class="fas fa-file-upload"></i> Subir Documentos (PDF)
    </label>
    <input type="file" id="pro_documentos" name="pro_documentos" accept=".pdf">
    <div class="file-name">Ning√∫n archivo seleccionado</div>

    <button type="submit" class="btn-submit">Inscribir Proyecto</button>
  </form>
</main>



  <!-- Modal encontrado -->
<div id="modalEncontrado" class="modal hidden">
  <div class="modal-content modal-exito">
    <h2 class="modal-title">‚úÖ Proyecto Encontrado</h2>

    <div class="modal-detalles">
      <p><strong>Nombre:</strong> <span id="nombre_proyecto"></span></p>
      <p><strong>Descripci√≥n:</strong> <span id="descripcion_proyecto"></span></p>
      <p><strong>C√≥digo:</strong> <span id="codigo_proyecto"></span></p>
      <p><strong>Expositores:</strong> <span id="expositores_proyecto"></span></p>
    </div>

    <div class="modal-footer">
      <button id="btnCerrarEncontrado" data-modal="modalEncontrado" class="btn-cerrar">
        Cerrar
      </button>
    </div>
  </div>
</div>


<!-- Modal no encontrado -->
<div id="modalNoEncontrado" class="modal hidden">
  <div class="modal-content">
    <h2>No Encontrado ‚ùå</h2>
    <p>El c√≥digo ingresado no corresponde a ning√∫n proyecto.</p>
    <button class="btn-cerrar" id="btnCerrarNo" data-modal="modalNoEncontrado">Cerrar</button>
  </div>
</div>
  <script src="{% static 'app_visitante/js/form_parti.js' %}" defer></script>
  <script>
    const urlBuscarProyecto = "{% url 'app_visitante:buscar_proyecto' 'CODIGO_TEMPORAL' %}";
  </script>
</body>

</html>
