{% load static %}
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Informaci√≥n del Evento</title>

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="{% static 'app_visitante/css/detalle_evento.css' %}"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />

    <style>
      .extra-buttons {
        display: none;
        margin-top: 10px;
      }

      .modal-compartir {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        align-items: center;
        justify-content: center;
      }

      .modal-contenido {
        background: #fff;
        padding: 20px;
        border-radius: 10px;
        width: 90%;
        max-width: 500px;
        text-align: center;
      }

      .cerrar {
        float: right;
        font-size: 1.5rem;
        cursor: pointer;
      }
    </style>
  </head>

  <body>
    <div class="header">
      <a
        href="{% url 'inicio_visitante' %}"
        class="floating-home-btn"
        title="Inicio"
      >
        <i class="fas fa-home"></i>
      </a>
      Informaci√≥n del Evento
    </div>

    <div class="main-container">
      <div class="info-section">
        <div class="info-image">
          <img
            src="{{ evento.eve_imagen.url }}"
            alt="{{ evento.eve_nombre }}"
          />
        </div>

        <div class="info-content">
          <h2>{{ evento.eve_nombre }}</h2>
          <p>{{ evento.eve_descripcion }}</p>

          <div class="info-item">
            <i class="fas fa-map-marker-alt"></i>
            <span>Lugar: {{ evento.eve_lugar }}</span>
          </div>
          <div class="info-item">
            <i class="fas fa-calendar-alt"></i>
            <span
              >Fecha: {{ evento.eve_fecha_inicio }} al {{ evento.eve_fecha_fin}}</span
            >
          </div>

          <a
            href="{{ evento.eve_programacion.url }}"
            target="_blank"
            rel="noopener"
            class="programacion-link"
          >
            <i class="fas fa-file-alt"></i> Ver programaci√≥n
          </a>

          <div class="action-buttons">
            {% if usuario_inscrito_asistente %}
            <button class="action-btn disabled" disabled>
              <i class="fas fa-check"></i> Ya est√°s inscrito como asistente
            </button>
            {% else %}
            <a
              href="{% url 'preinscripcion_asistente' evento.id %}"
              class="action-btn"
            >
              <i class="fas fa-user"></i> Preinscribirme como asistente
            </a>
            {% endif %}

            <button class="action-btn-outline" onclick="mostrarOpciones()">
              M√°s opciones
            </button>

            <div id="opciones-ocultas" class="extra-buttons">
              {% if usuario_inscrito_participante %}
              <button class="action-btn disabled" disabled>
                <i class="fas fa-check"></i> Ya est√°s inscrito como participante
              </button>
              {% else %}
              <a
                href="{% url 'preinscripcion_participante' evento.id %}"
                class="action-btn"
              >
                <i class="fas fa-pen"></i> Preinscribirme como participante
              </a>
              {% endif %} {% if usuario_inscrito_evaluador %}
              <button class="action-btn disabled" disabled>
                <i class="fas fa-check"></i> Ya est√°s inscrito como evaluador
              </button>
              {% else %}
              <a
                href="{% url 'preinscripcion_evaluador' evento.id %}"
                class="action-btn"
              >
                <i class="fa-solid fa-chalkboard-user"></i> Preinscribirme como
                Evaluador
              </a>
              {% endif %}
            </div>
          </div>

          <!-- Bot√≥n Compartir -->
          <button class="action-btn-outline" onclick="abrirCompartir()">
            <i class="fas fa-share-alt"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- MODAL COMPARTIR -->
    <div id="modal-compartir" class="modal-compartir">
      <div class="modal-contenido">
        <span class="cerrar" onclick="cerrarCompartir()">&times;</span>
        <h3>Compartir este evento</h3>

        <a
          href="https://wa.me/?text=Mira%20este%20evento%20en%20el%20que%20estoy%20participando:%0Aüìå%20{{ evento.eve_nombre }}%0AüìÖ%20Fecha:%20{{ evento.eve_fecha_inicio }}%20al%20{{ evento.eve_fecha_fin }}%0Aüìç%20Lugar:%20{{ evento.eve_lugar }}%0Aüëâ%20Ver%20m√°s:%20{{ request.build_absolute_uri }}"
          target="_blank"
        >
          <i class="fab fa-whatsapp"></i> WhatsApp </a
        ><br />

        <a
          href="mailto:?subject=Te invito a este evento&body=Mira%20este%20evento%20en%20el%20que%20estoy%20participando:%0Aüìå%20{{ evento.eve_nombre }}%0AüìÖ%20Fecha:%20{{ evento.eve_fecha_inicio }}%20al%20{{ evento.eve_fecha_fin }}%0Aüìç%20Lugar:%20{{ evento.eve_lugar }}%0Aüëâ%20Ver%20m√°s:%20{{ request.build_absolute_uri }}"
        >
          <i class="fas fa-envelope"></i> Correo </a
        ><br />

        <a
          href="https://t.me/share/url?url={{ request.build_absolute_uri }}&text=Mira%20este%20evento%20en%20el%20que%20estoy%20participando:%0Aüìå%20{{ evento.eve_nombre }}%0AüìÖ%20Fecha:%20{{ evento.eve_fecha_inicio }}%20al%20{{ evento.eve_fecha_fin }}%0Aüìç%20Lugar:%20{{ evento.eve_lugar }}%0Aüìù%20Descripci√≥n:%20{{ evento.eve_descripcion }}"
          target="_blank"
        >
          <i class="fab fa-telegram"></i> Telegram </a
        ><br />

        <button onclick="copiarTexto()">üìã Copiar mensaje</button>
      </div>
    </div>

    <script>
      function mostrarOpciones() {
        const opciones = document.getElementById("opciones-ocultas");
        const btn = document.querySelector(".action-btn-outline");

        if (
          opciones.style.display === "none" ||
          opciones.style.display === ""
        ) {
          opciones.style.display = "block";
          btn.textContent = "Ocultar opciones";
        } else {
          opciones.style.display = "none";
          btn.textContent = "M√°s opciones";
        }
      }

      function abrirCompartir() {
        document.getElementById("modal-compartir").style.display = "flex";
      }

      function cerrarCompartir() {
        document.getElementById("modal-compartir").style.display = "none";
      }

      function copiarTexto() {
        const texto = `Mira este evento en el que estoy participando:
üìå {{ evento.eve_nombre }}
üìÖ Fecha: {{ evento.eve_fecha_inicio }} al {{ evento.eve_fecha_fin }}
üìç Lugar: {{ evento.eve_lugar }}
üëâ Ver m√°s: {{ request.build_absolute_uri }}`;

        navigator.clipboard.writeText(texto).then(() => {
          alert("¬°Mensaje copiado! Puedes pegarlo donde quieras.");
        });
      }
    </script>
  </body>
</html>
