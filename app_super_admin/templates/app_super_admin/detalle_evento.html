{% extends 'app_super_admin/base.html' %}
{% load static %}

{% block title %}Información del Evento{% endblock %}

{% block content %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<!-- Encabezado principal -->
<header class="bg-success text-white text-center py-3 mb-4 shadow-sm">
  <h1 class="fw-bold">Información del Evento</h1>
</header>

<!-- Contenedor principal -->
<div class="container d-flex flex-column align-items-center mb-5">

  <!-- Tarjeta principal -->
  <div class="card shadow-lg border-0 w-100" style="max-width: 1000px;">
    <div class="row g-0">

      <!-- Imagen del evento -->
      <div class="col-md-6">
        {% if evento.eve_imagen %}
          <img src="{{ evento.eve_imagen.url }}" alt="Imagen del evento"
               class="img-fluid rounded-start" style="object-fit: cover; height: 100%;">
        {% elif evento.imagen_url %}
          <img src="{{ evento.imagen_url }}" alt="Imagen del evento"
               class="img-fluid rounded-start" style="object-fit: cover; height: 100%;">
        {% else %}
          <div class="d-flex align-items-center justify-content-center bg-light rounded-start" style="height: 100%;">
            <span class="text-muted">Sin imagen</span>
          </div>
        {% endif %}
      </div>

      <!-- Información del evento -->
      <div class="col-md-6 p-4">
        <h2 class="fw-bold mb-2">{{ evento.eve_nombre|default:"Evento no asignado" }}</h2>
        <h5 class="text-muted mb-3">
          Organizado por {{ evento.eve_administrador_fk.usuario.first_name }} {{ evento.eve_administrador_fk.usuario.last_name }}
        </h5>

        {% if evento.eve_descripcion %}
        <p><strong>Descripción:</strong> {{ evento.eve_descripcion }}</p>
        {% endif %}

        <p>
          <strong>Inicio:</strong> {{ evento.eve_fecha_inicio|default:"Fecha por definir" }}<br>
          {% if evento.eve_fecha_fin %}
            <strong>Fin:</strong> {{ evento.eve_fecha_fin }}<br>
          {% endif %}
          <strong>Lugar:</strong> {{ evento.eve_lugar|default:"Por definir" }}{% if evento.eve_ciudad %}, {{ evento.eve_ciudad }}{% endif %}
        </p>

        <ul class="list-unstyled mt-3">
          {% if evento.eve_estado %}
          <li><i class="bi bi-flag-fill text-success"></i> <strong>Estado:</strong> {{ evento.eve_estado }}</li>
          {% endif %}
          {% if evento.eve_capacidad %}
          <li><i class="bi bi-people-fill text-primary"></i> <strong>Capacidad:</strong> {{ evento.eve_capacidad }}</li>
          {% endif %}
          {% if evento.eve_programacion %}
          <li>
            <i class="bi bi-file-earmark-text-fill text-info"></i>
            <strong>Programación:</strong>
            <a href="{{ evento.eve_programacion.url }}" class="btn btn-outline-success btn-sm ms-2" target="_blank">
              Ver programación
            </a>
          </li>
          {% endif %}
        </ul>

        <!-- Botones de acción -->
        <div class="mt-4 d-flex gap-2">
          {% if evento.eve_estado != "Cancelado" %}
            <button class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#modalCancelarEvento">
              Cancelar evento
            </button>
          {% else %}
            <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#modalActivarEvento">
              Activar evento
            </button>
          {% endif %}
          <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#modalEliminarEvento">
            Eliminar evento
          </button>
        </div>

      </div>
    </div>
  </div>

  <!-- Botón volver -->
  <a href="{% url 'super_admin:index_super_admin' %}" 
     class="btn btn-outline-success mt-4 shadow-sm px-4">
     <i class="bi bi-arrow-left"></i> Volver al panel
  </a>
</div>


<!-- =======================
     MODALES DE ACCIÓN
======================= -->

<!-- Modal Cancelar Evento -->
<div class="modal fade" id="modalCancelarEvento" tabindex="-1" aria-labelledby="cancelarEventoLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-warning">
        <h5 class="modal-title text-dark" id="cancelarEventoLabel">Cancelar evento</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
        ¿Estás seguro de que deseas cancelar este evento? Esta acción no lo eliminará, pero lo marcará como cancelado.
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">No</button>
        <a href="{% url 'super_admin:cancelar_evento' evento.id %}" class="btn btn-warning">Sí, cancelar</a>
      </div>
    </div>
  </div>
</div>

<!-- Modal Activar Evento -->
<div class="modal fade" id="modalActivarEvento" tabindex="-1" aria-labelledby="activarEventoLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-success text-white">
        <h5 class="modal-title" id="activarEventoLabel">Activar evento</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
        ¿Deseas activar nuevamente este evento? Será visible en la web para los usuarios.
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">No</button>
        <a href="{% url 'super_admin:modificar_eventos' evento.id 'activo' %}" class="btn btn-success">Sí, activar</a>
      </div>
    </div>
  </div>
</div>

<!-- Modal Eliminar Evento -->
<div class="modal fade" id="modalEliminarEvento" tabindex="-1" aria-labelledby="eliminarEventoLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-danger text-white">
        <h5 class="modal-title" id="eliminarEventoLabel">Eliminar evento</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body">
        ⚠️ Esta acción eliminará el evento de forma permanente. ¿Deseas continuar?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <a href="{% url 'super_admin:eliminar_evento' evento.id %}" class="btn btn-danger">Sí, eliminar</a>
      </div>
    </div>
  </div>
</div>

{% endblock %}
